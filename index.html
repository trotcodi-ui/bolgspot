<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KR Lotto Web</title>

<style>
body{
  margin:0;
  padding:15px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  background:#f5f6f8;
}
.box{
  background:#ffffff;
  border-radius:12px;
  padding:20px;
  margin-bottom:20px;
}
h2{
  margin-top:0;
  font-size:20px;
}
p{
  color:#555;
  line-height:1.6;
  font-size:14px;
}
input, select, button{
  width:100%;
  padding:12px;
  margin-top:10px;
  font-size:15px;
}
button{
  background:#1976d2;
  color:#fff;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
button:hover{
  background:#125ea7;
}
.result{
  margin-top:15px;
  font-size:14px;
}
.history-item{
  padding:8px 0;
  border-bottom:1px solid #eee;
}
.num{
  display:inline-block;
  width:36px;
  height:36px;
  line-height:36px;
  margin:4px;
  text-align:center;
  border-radius:50%;
  background:#e3f2fd;
  font-weight:bold;
  color:#0d47a1;
}
.section-title{
  margin-top:15px;
  font-weight:bold;
}
</style>
</head>

<body>

<div class="box">
  <h2>1. 로또 번호 이력 조회</h2>
  <p>
    입력한 로또 번호가 과거 회차에서  
    1·2·3등에 해당한 이력이 있는지 확인할 수 있습니다.
  </p>

  <input id="userNums" placeholder="예: 3,12,19,25,33,42">
  <button onclick="checkHistory()">이력 조회</button>

  <div id="historyResult" class="result"></div>
</div>

<div class="box">
  <h2>2. 회차 선택 통계 기반 번호 분석</h2>
  <p>
    선택한 회차 수 동안의 출현 빈도를 기준으로  
    가장 많이 나온 숫자와 가장 적게 나온 숫자를 분석합니다.
  </p>

  <select id="range">
    <option value="10">최근 10회</option>
    <option value="20">최근 20회</option>
    <option value="30">최근 30회</option>
    <option value="50">최근 50회</option>
    <option value="100">최근 100회</option>
  </select>

  <button onclick="analyze()">통계 분석</button>

  <div id="analysisResult" class="result"></div>
</div>

<script>
var JSON_URL =
  "https://raw.githubusercontent.com/trotcodi-ui/2025lotto/main/2025lotto_numbers_1_to_1182_final.json";

var lottoData = [];

fetch(JSON_URL)
  .then(function(res){ return res.json(); })
  .then(function(data){ lottoData = data; });

function parseNumbers(str){
  return str.split(",").map(function(n){
    return parseInt(n.trim(),10);
  }).filter(function(n){
    return n>=1 && n<=45;
  });
}

function checkHistory(){
  var nums = parseNumbers(document.getElementById("userNums").value);
  var result = "";

  if(nums.length !== 6){
    alert("번호 6개를 입력하세요.");
    return;
  }

  lottoData.forEach(function(d){
    var match = 0;
    nums.forEach(function(n){
      if(d.numbers.indexOf(n) > -1) match++;
    });

    if(match >= 4){
      var rank = match===6 ? "1등" : match===5 ? "2등" : "3등";
      result +=
        '<div class="history-item">' +
        d.draw_no + '회차 : ' + rank +
        '</div>';
    }
  });

  document.getElementById("historyResult").innerHTML =
    result || "과거 1·2·3등 이력이 없습니다.";
}

function analyze(){
  var range = parseInt(document.getElementById("range").value,10);
  var freq = {};
  for(var i=1;i<=45;i++) freq[i]=0;

  lottoData.slice(-range).forEach(function(d){
    d.numbers.forEach(function(n){
      freq[n]++;
    });
  });

  var sorted = Object.entries(freq).sort(function(a,b){
    return b[1]-a[1];
  });

  var html = '<div class="section-title">가장 많이 나온 숫자</div>';
  sorted.slice(0,6).forEach(function(n){
    html += '<span class="num">'+n[0]+'</span>';
  });

  html += '<div class="section-title" style="margin-top:12px;">가장 적게 나온 숫자</div>';
  sorted.slice(-6).forEach(function(n){
    html += '<span class="num">'+n[0]+'</span>';
  });

  document.getElementById("analysisResult").innerHTML = html;
}
</script>

</body>
</html>

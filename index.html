<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lotto Statistics Tool</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
  padding: 20px;
}
.container {
  max-width: 720px;
  margin: auto;
}
.card {
  background: #fff;
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 10px;
}
h1 { font-size: 22px; }
h2 { font-size: 18px; margin-bottom: 10px; }
select, button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 15px;
}
button {
  background: #2563eb;
  color: #fff;
  border: none;
  border-radius: 6px;
}
.ball {
  display: inline-block;
  width: 36px;
  height: 36px;
  line-height: 36px;
  text-align: center;
  border-radius: 50%;
  background: #e0ecff;
  margin: 4px;
  font-weight: bold;
}
.line {
  margin-bottom: 8px;
}
</style>
</head>

<body>
<div class="container">

<h1>로또 번호 통계 분석 도구</h1>

<div class="card">
  <h2>회차 선택 통계 분석</h2>

  <select id="roundCount">
    <option value="10">최근 10회</option>
    <option value="20">최근 20회</option>
    <option value="30">최근 30회</option>
    <option value="50">최근 50회</option>
    <option value="100">최근 100회</option>
  </select>

  <button onclick="analyze()">통계 분석 실행</button>

  <h3>가장 많이 나온 숫자</h3>
  <div id="most"></div>

  <h3>가장 적게 나온 숫자</h3>
  <div id="least"></div>

  <h3>추천 번호 (5세트)</h3>
  <div id="recommend"></div>
</div>

</div>

<script>
const DATA_URL = "https://raw.githubusercontent.com/trotcodi-ui/2025lotto/main/2025lotto_numbers_1_to_1182_final.json";
let lottoData = [];

fetch(DATA_URL)
  .then(res => res.json())
  .then(data => {
    lottoData = data;
  });

function analyze() {
  if (lottoData.length === 0) {
    alert("데이터 로딩 중입니다. 잠시 후 다시 시도하세요.");
    return;
  }

  const count = parseInt(document.getElementById("roundCount").value);
  const recent = lottoData.slice(-count);

  const freq = {};
  for (let i = 1; i <= 45; i++) freq[i] = 0;

  recent.forEach(d => d.numbers.forEach(n => freq[n]++));

  const sorted = Object.entries(freq)
    .map(([n, c]) => [parseInt(n), c])
    .sort((a, b) => b[1] - a[1]);

  render("most", sorted.slice(0, 6).map(v => v[0]));
  render("least", sorted.slice(-6).map(v => v[0]));
  generate(sorted.slice(0, 20));
}

function render(id, nums) {
  const el = document.getElementById(id);
  el.innerHTML = "";
  nums.forEach(n => {
    const s = document.createElement("span");
    s.className = "ball";
    s.textContent = n;
    el.appendChild(s);
  });
}

function generate(pool) {
  const el = document.getElementById("recommend");
  el.innerHTML = "";

  for (let i = 0; i < 5; i++) {
    const pick = [];
    while (pick.length < 6) {
      const n = pool[Math.floor(Math.random() * pool.length)][0];
      if (!pick.includes(n)) pick.push(n);
    }
    pick.sort((a, b) => a - b);

    const line = document.createElement("div");
    line.className = "line";
    pick.forEach(n => {
      const s = document.createElement("span");
      s.className = "ball";
      s.textContent = n;
      line.appendChild(s);
    });
    el.appendChild(line);
  }
}
</script>

</body>
</html>
